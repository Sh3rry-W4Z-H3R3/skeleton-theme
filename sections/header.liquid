<header class="agh-header">
  <div class="header-container">
    <!-- Logo/Brand -->
    <div class="header-brand">
      <a href="{{ routes.root_url }}" class="brand-link">
        <img
          src="{{ 'AGH Logo GreenAsset 1@4x.png' | asset_url }}"
          alt="Andra's Garden Heaven Logo"
          class="brand-logo"
          width="120"
          height="40"
        >
      </a>
    </div>

    <!-- Desktop Navigation - HIDDEN ON MOBILE/TABLET -->
    <nav class="header-nav desktop-nav">
      {% for link in section.settings.menu.links %}
        <a href="{{ link.url }}" class="nav-link">{{ link.title }}</a>
      {% endfor %}
    </nav>

    <!-- Desktop Search Bar - HIDDEN ON MOBILE/TABLET -->
    <div class="header-search desktop-search">
      <form action="{{ routes.search_url }}" method="get" class="search-form">
        <div class="search-input-group">
          <input
            type="search"
            name="q"
            placeholder="Search garden furniture..."
            class="search-input"
            value="{{ search.terms | escape }}"
          >
          <button type="submit" class="search-btn" aria-label="Search">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14Z" fill="currentColor"/>
            </svg>
          </button>
        </div>
      </form>
    </div>

    <!-- Header Icons -->
    <div class="header-icons">
      {% if shop.customer_accounts_enabled %}
        <a href="{{ routes.account_url }}" class="icon-link" aria-label="Account">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" fill="currentColor"/>
          </svg>
        </a>
      {% endif %}

      <a href="{{ routes.cart_url }}" class="icon-link cart-link" aria-label="Cart">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M17,18C15.89,18 15,18.89 15,20A2,2 0 0,0 17,22A2,2 0 0,0 19,20C19,18.89 18.1,18 17,18M1,2V4H3L6.6,11.59L5.24,14.04C5.09,14.32 5,14.65 5,15A2,2 0 0,0 7,17H19V15H7.42A0.25,0.25 0 0,1 7.17,14.75C7.17,14.7 7.18,14.66 7.2,14.63L8.1,13H15.55C16.3,13 16.96,12.58 17.3,11.97L20.88,5H5.21L4.27,3H1M7,18C5.89,18 5,18.89 5,20A2,2 0 0,0 7,22A2,2 0 0,0 9,20C9,18.89 8.1,18 7,18Z" fill="currentColor"/>
        </svg>
        {% if cart.item_count > 0 %}
          <span class="cart-count">{{ cart.item_count }}</span>
        {% endif %}
      </a>

      <!-- Mobile Menu Toggle - VISIBLE ONLY ON MOBILE/TABLET -->
      <button class="mobile-menu-toggle" aria-label="Toggle menu" aria-expanded="false">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>
    </div>
  </div>

  <!-- Mobile Navigation Overlay -->
  <div class="mobile-nav-overlay">
    <nav class="mobile-nav">
      <div class="mobile-search">
        <form action="{{ routes.search_url }}" method="get" class="mobile-search-form">
          <input
            type="search"
            name="q"
            placeholder="Search garden furniture..."
            class="mobile-search-input"
            value="{{ search.terms | escape }}"
          >
          <button type="submit" class="mobile-search-btn" aria-label="Search">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14Z" fill="currentColor"/>
            </svg>
          </button>
        </form>
      </div>

      <div class="mobile-menu-links">
        {% for link in section.settings.menu.links %}
          <a href="{{ link.url }}" class="mobile-nav-link">{{ link.title }}</a>
        {% endfor %}
      </div>

      <div class="mobile-menu-footer">
        {% if shop.customer_accounts_enabled %}
          <a href="{{ routes.account_url }}" class="mobile-account-link">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" fill="currentColor"/>
            </svg>
            Account
          </a>
        {% endif %}
      </div>
    </nav>
  </div>
</header>

<style>
  /* HEADER STYLES - ENHANCED VERSION */
  .agh-header {
    position: sticky;
    top: 0;
    z-index: 9999;
    background: rgba(227, 245, 215, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 2px solid var(--green200);
    width: 100%;
    box-shadow: 0 4px 20px rgba(28, 66, 25, 0.1);
    transition: all 0.3s ease;
  }

  .header-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 80px;
    transition: height 0.3s ease;
  }

  .header-brand {
    flex-shrink: 0;
  }

  .brand-logo {
    height: 40px;
    width: auto;
    transition: transform 0.3s ease;
  }

  .brand-logo:hover {
    transform: scale(1.05);
  }

  /* DESKTOP NAVIGATION - VISIBLE ON LAPTOPS/DESKTOPS */
  .desktop-nav {
    display: flex;
    gap: 2.5rem;
    margin: 0 2rem;
    opacity: 1;
    transform: translateY(0);
    transition: all 0.3s ease;
  }

  .nav-link {
    text-decoration: none;
    color: var(--green);
    font-weight: 500;
    font-family: var(--heading-font);
    font-size: 1rem;
    transition: all 0.3s ease;
    position: relative;
    padding: 0.5rem 0;
  }

  .nav-link::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--green);
    transition: width 0.3s ease;
  }

  .nav-link:hover::after {
    width: 100%;
  }

  .nav-link:hover {
    color: var(--green600);
    transform: translateY(-2px);
  }

  /* DESKTOP SEARCH - VISIBLE ON LAPTOPS/DESKTOPS */
  .desktop-search {
    flex: 1;
    max-width: 400px;
    margin: 0 1rem;
    opacity: 1;
    transform: translateY(0);
    transition: all 0.3s ease;
  }

  .search-input-group {
    position: relative;
    display: flex;
    align-items: center;
  }

  .search-input {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 2px solid var(--green200);
    border-radius: 25px;
    background: var(--white);
    color: var(--green);
    font-family: var(--body-font);
    transition: all 0.3s ease;
  }

  .search-input:focus {
    outline: none;
    border-color: var(--green400);
    box-shadow: 0 0 0 3px rgba(28, 66, 25, 0.1);
  }

  .search-btn {
    position: absolute;
    right: 8px;
    background: none;
    border: none;
    color: var(--green);
    cursor: pointer;
    padding: 4px;
    transition: transform 0.3s ease;
  }

  .search-btn:hover {
    transform: scale(1.1);
  }

  .header-icons {
    display: flex;
    align-items: center;
    gap: 1.5rem;
  }

  .icon-link {
    color: var(--green);
    text-decoration: none;
    transition: all 0.3s ease;
    position: relative;
    padding: 0.5rem;
    border-radius: 50%;
  }

  .icon-link:hover {
    color: var(--green600);
    background: rgba(28, 66, 25, 0.1);
    transform: translateY(-2px);
  }

  .cart-count {
    background: var(--green);
    color: var(--white);
    border-radius: 50%;
    padding: 2px 6px;
    font-size: 0.75rem;
    position: absolute;
    top: -8px;
    right: -8px;
    font-weight: 600;
  }

  /* HAMBURGER MENU - HIDDEN BY DEFAULT */
  .mobile-menu-toggle {
    display: none;
    flex-direction: column;
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
    gap: 4px;
    width: 44px;
    height: 44px;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    transition: all 0.3s ease;
  }

  .mobile-menu-toggle:hover {
    background-color: rgba(28, 66, 25, 0.1);
    transform: scale(1.05);
  }

  .hamburger-line {
    width: 24px;
    height: 3px;
    background: var(--green);
    border-radius: 2px;
    transition: all 0.3s ease;
  }

  .mobile-menu-toggle.active .hamburger-line:nth-child(1) {
    transform: rotate(45deg) translate(6px, 6px);
  }

  .mobile-menu-toggle.active .hamburger-line:nth-child(2) {
    opacity: 0;
  }

  .mobile-menu-toggle.active .hamburger-line:nth-child(3) {
    transform: rotate(-45deg) translate(6px, -6px);
  }

  /* MOBILE NAVIGATION OVERLAY */
  .mobile-nav-overlay {
    position: fixed;
    top: 80px;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(227, 245, 215, 0.98);
    backdrop-filter: blur(10px);
    transform: translateX(-100%);
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 9998;
    overflow-y: auto;
  }

  .mobile-nav-overlay.active {
    transform: translateX(0);
  }

  .mobile-nav {
    padding: 2rem;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .mobile-search {
    margin-bottom: 2rem;
  }

  .mobile-search-input {
    width: 100%;
    padding: 1rem;
    border: 2px solid var(--green200);
    border-radius: 25px;
    background: var(--white);
    color: var(--green);
    font-family: var(--body-font);
    transition: all 0.3s ease;
  }

  .mobile-search-input:focus {
    outline: none;
    border-color: var(--green400);
    box-shadow: 0 0 0 3px rgba(28, 66, 25, 0.1);
  }

  .mobile-menu-links {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  .mobile-nav-link {
    text-decoration: none;
    color: var(--green);
    font-size: 1.2rem;
    font-weight: 500;
    font-family: var(--heading-font);
    padding: 1.25rem 0;
    border-bottom: 1px solid var(--green200);
    transition: all 0.3s ease;
    position: relative;
  }

  .mobile-nav-link::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 2px;
    background: var(--green);
    transition: width 0.3s ease;
  }

  .mobile-nav-link:hover::after {
    width: 100%;
  }

  .mobile-nav-link:hover {
    color: var(--green600);
    padding-left: 1rem;
  }

  .mobile-menu-footer {
    margin-top: 2rem;
    padding-top: 1rem;
    border-top: 2px solid var(--green200);
  }

  .mobile-account-link {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: var(--green);
    text-decoration: none;
    font-family: var(--heading-font);
    font-weight: 500;
    font-size: 1.1rem;
    padding: 1rem 0;
    transition: all 0.3s ease;
  }

  .mobile-account-link:hover {
    color: var(--green600);
    transform: translateX(0.5rem);
  }

  /* RESPONSIVE BREAKPOINTS - ENHANCED TRANSITIONS */

  /* TABLETS (max-width: 1024px) - SHOW HAMBURGER */
  @media screen and (max-width: 1024px) {
    .desktop-nav {
      opacity: 0;
      transform: translateY(-10px);
      pointer-events: none;
    }

    .desktop-search {
      opacity: 0;
      transform: translateY(-10px);
      pointer-events: none;
    }

    .mobile-menu-toggle {
      display: flex;
      opacity: 1;
      transform: translateY(0);
    }

    .header-container {
      height: 70px;
    }

    .mobile-nav-overlay {
      top: 70px;
    }

    .brand-logo {
      height: 35px;
    }
  }

  /* LAPTOPS AND DESKTOPS (min-width: 1025px) - HIDE HAMBURGER */
  @media screen and (min-width: 1025px) {
    .mobile-menu-toggle {
      display: none !important;
      opacity: 0;
      transform: translateY(-10px);
    }

    .mobile-nav-overlay {
      display: none !important;
    }

    .desktop-nav {
      display: flex !important;
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    .desktop-search {
      display: block !important;
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }
  }

  /* SMALL MOBILE (max-width: 480px) */
  @media screen and (max-width: 480px) {
    .header-container {
      height: 60px;
      padding: 0 0.75rem;
    }

    .brand-logo {
      height: 30px;
    }

    .mobile-nav-overlay {
      top: 60px;
    }

    .mobile-nav {
      padding: 1.5rem;
    }

    .mobile-nav-link {
      font-size: 1.1rem;
      padding: 1rem 0;
    }

    .header-icons {
      gap: 1rem;
    }
  }

  /* EXTRA SMALL MOBILE (max-width: 360px) */
  @media screen and (max-width: 360px) {
    .header-container {
      padding: 0 0.5rem;
    }

    .brand-logo {
      height: 28px;
    }

    .mobile-nav {
      padding: 1rem;
    }
  }
</style>

<script>
  // MOBILE MENU FUNCTIONALITY - ENHANCED
  document.addEventListener('DOMContentLoaded', function () {
    console.log('Header script loaded - ENHANCED VERSION');

    const mobileToggle = document.querySelector('.mobile-menu-toggle');
    const mobileOverlay = document.querySelector('.mobile-nav-overlay');
    const body = document.body;
    const header = document.querySelector('.agh-header');

    console.log('Mobile toggle element:', mobileToggle);
    console.log('Mobile overlay element:', mobileOverlay);

    if (mobileToggle && mobileOverlay) {
      mobileToggle.addEventListener('click', function (e) {
        e.preventDefault();
        e.stopPropagation();

        console.log('Hamburger clicked - ENHANCED VERSION');

        const isActive = mobileOverlay.classList.contains('active');

        if (isActive) {
          mobileOverlay.classList.remove('active');
          mobileToggle.classList.remove('active');
          mobileToggle.setAttribute('aria-expanded', 'false');
          body.style.overflow = '';
          header.style.background = 'rgba(227, 245, 215, 0.95)';
        } else {
          mobileOverlay.classList.add('active');
          mobileToggle.classList.add('active');
          mobileToggle.setAttribute('aria-expanded', 'true');
          body.style.overflow = 'hidden';
          header.style.background = 'rgba(227, 245, 215, 0.98)';
        }
      });

      // Close mobile menu when clicking on a link
      const mobileLinks = mobileOverlay.querySelectorAll('a');
      mobileLinks.forEach((link) => {
        link.addEventListener('click', function () {
          mobileOverlay.classList.remove('active');
          mobileToggle.classList.remove('active');
          mobileToggle.setAttribute('aria-expanded', 'false');
          body.style.overflow = '';
          header.style.background = 'rgba(227, 245, 215, 0.95)';
        });
      });

      // Close mobile menu when clicking outside
      mobileOverlay.addEventListener('click', function (e) {
        if (e.target === mobileOverlay) {
          mobileOverlay.classList.remove('active');
          mobileToggle.classList.remove('active');
          mobileToggle.setAttribute('aria-expanded', 'false');
          body.style.overflow = '';
          header.style.background = 'rgba(227, 245, 215, 0.95)';
        }
      });

      // Close mobile menu on window resize if switching to desktop
      window.addEventListener('resize', function () {
        if (window.innerWidth >= 1025) {
          mobileOverlay.classList.remove('active');
          mobileToggle.classList.remove('active');
          mobileToggle.setAttribute('aria-expanded', 'false');
          body.style.overflow = '';
          header.style.background = 'rgba(227, 245, 215, 0.95)';
        }
      });

      // Add scroll effect to header
      window.addEventListener('scroll', function () {
        if (window.scrollY > 50) {
          header.style.background = 'rgba(227, 245, 215, 0.98)';
          header.style.boxShadow = '0 4px 20px rgba(28, 66, 25, 0.15)';
        } else {
          header.style.background = 'rgba(227, 245, 215, 0.95)';
          header.style.boxShadow = '0 4px 20px rgba(28, 66, 25, 0.1)';
        }
      });
    } else {
      console.error('Mobile menu elements not found - ENHANCED VERSION');
    }
  });
</script>

{% schema %}
{
  "name": "t:general.header",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "label": "t:labels.menu"
    }
  ]
}
{% endschema %}
